<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cup Lighton | Products</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <!-- Header -->
    <header>
        <a href="index.html">
            <img src="images/logo/cupLight.png" class="logo" alt="Cup Lighton Logo">
        </a>
        <nav>
            <a href="index.html">Home</a>
            <a href="index.html#projects">Projects</a>
            <a href="products.html">Products</a>
            <a href="contactUs.html">Contact</a>
        </nav>
    </header>

    <!-- Page Layout -->
    <div class="products-page-wrapper">

        <!-- LEFT SIDEBAR (Categories) -->
        <aside class="products-sidebar">
            <h3>Categories</h3>
            <div id="category-list">
                <div class="products-category-item products-category-active" data-category="all">All Products</div>
                <div class="products-category-item" data-category="indoor">Indoor</div>
                <div class="products-category-item" data-category="outdoor">Outdoor</div>
                <div class="products-category-item" data-category="decorative">Decorative</div>
                <div class="products-category-item" data-category="solar">Solar</div>
            </div>
        </aside>

        <!-- RIGHT CONTENT -->
        <section class="products-content-area">

            <div id="status" class="products-status">Loading products...</div>

            <div id="product-grid" class="products-grid">
                <!-- Products will be loaded from data.json -->
            </div>

        </section>

    </div>

    <!-- Footer -->
    <footer>
        © 2025 Cup Lighton — All Rights Reserved
    </footer>

    <!-- SCRIPT -->
    <script>
        const statusEl = document.getElementById("status");
        const categoryItems = document.querySelectorAll(".products-category-item");
        const productGrid = document.getElementById("product-grid");
        let allProducts = [];

        // Load products from data.json
        async function loadProducts() {
            try {
                const response = await fetch('data.json');
                allProducts = await response.json();

                // Render all products initially
                renderProducts(allProducts);
                statusEl.textContent = `Showing all ${allProducts.length} product(s).`;
            } catch (error) {
                console.error('Error loading products:', error);
                statusEl.textContent = 'Failed to load products.';
                productGrid.innerHTML = '<p style="text-align: center; color: #666;">Failed to load products. Please try again later.</p>';
            }
        }

        // Render products to the grid
        function renderProducts(products) {
            productGrid.innerHTML = '';

            products.forEach(product => {
                const card = document.createElement('div');
                card.className = 'products-card';
                card.setAttribute('data-category', product.category);
                card.style.cursor = 'pointer';

                // Add click event to navigate to product detail page
                card.addEventListener('click', (e) => {
                    // Don't navigate if clicking the datasheet button
                    if (!e.target.classList.contains('products-card-btn')) {
                        window.location.href = `productDetail.html?id=${product.id}`;
                    }
                });

                card.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <h3 class="products-card-title">${product.name}</h3>
                    <div class="products-card-category">${capitalize(product.category)}</div>
                    <div class="products-card-bottom">
                        <span class="products-card-price">฿${product.price.toLocaleString()}</span>
                        <button class="products-card-btn" onclick="event.stopPropagation(); openPdf('${product.pdf}')">Datasheet</button>
                    </div>
                `;

                productGrid.appendChild(card);
            });
        }

        // Open local PDF in new tab
        function openPdf(path) {
            window.open(path, "_blank");
        }

        // Category filtering
        categoryItems.forEach(item => {
            item.addEventListener("click", () => {
                const category = item.dataset.category;

                // active state on sidebar
                categoryItems.forEach(c => c.classList.remove("products-category-active"));
                item.classList.add("products-category-active");

                // Filter products
                let filteredProducts;
                if (category === "all") {
                    filteredProducts = allProducts;
                } else {
                    filteredProducts = allProducts.filter(p => p.category === category);
                }

                // Render filtered products
                renderProducts(filteredProducts);

                // Update status
                if (category === "all") {
                    statusEl.textContent = `Showing all ${allProducts.length} product(s).`;
                } else {
                    statusEl.textContent = `Showing ${filteredProducts.length} product(s) in "${capitalize(category)}".`;
                }
            });
        });

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Load products on page load
        document.addEventListener('DOMContentLoaded', loadProducts);
    </script>

</body>

</html>